name: CI
on:
  pull_request:
  push:
    branches:
      - main
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v6
    - run: npm ci
    - run: npm test

  test-action:
    runs-on: ubuntu-latest
    needs: test
    steps:
    - uses: actions/checkout@v6
      with:
        fetch-depth: 0
    - name: Create new Semantic Version
      id: semver
      uses: ./
      with:
        bump: patch
        github_token: ${{ secrets.GITHUB_TOKEN }}
        dry_run: true
    - name: Output version
      run: echo "New version is ${{ steps.semver.outputs.version }}"
